\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={TMA4285 Timeseries, Exercise 3},
            pdfauthor={Marius Dioli, Amir Ahmed and Andreas Ferstad},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{TMA4285 Timeseries, Exercise 3}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Marius Dioli, Amir Ahmed and Andreas Ferstad}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{September 2019}

null

\begin{document}
\maketitle

\hypertarget{abstract}{%
\section{Abstract}\label{abstract}}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

\hypertarget{theory}{%
\section{Theory}\label{theory}}

\hypertarget{data-analysis}{%
\section{Data Analysis}\label{data-analysis}}

We start by creating simple time series plot to get an overview.

\#Averaging the montly reads so that we have one read per month

Just decomposing the time series, we see that there is a clear sesonal
trend, and a clear increasing general trend.

We plot the autoccorlation plot for the time series

Definitely not stationary, apply differencing, to see if it gets any
better.

Now plotting the transformed data we get:

Which could be a stationary process (we use this although there is some
early lag to keep our model less complex and to avoid overfitting).

So we decide on using \(\nabla\nabla^{12}\) as our tranformation.

Which results in a SARIMA model.

(Coefficient can i.e.~be fit using innovations algoritihm. But that
might not be the method impletemented in the package).

To find the best choice of parameters we compare AIC and AICC of
different models.

\(p=4, d=1, P=5, Q=1\) seems to be best choice of the remaining
parameters, where we get AIC and AICcc values of 1.27

With this chose of parameters our model would be:
\[\phi(B)\Phi(B)X_t = \theta(B)\Theta(B)Z_ t\] \[\theta(z)=1+\theta_1z\]
\[\Theta(z)=1+\Theta_1z\] \[\phi(z)=1-\phi_1z+\dots+\phi_ 4z^4\]
\[\Phi(z)=1-\Phi_1z+\dots+\Phi_5z^5\]

Fitting the model with the selected parameters, we get the following
diagnostic:

And the following coefficients \(\phi_1=\)-0.0585188,
\(\phi_2=\)-0.0697696, \(\phi_3=\)-0.0247383,\(\phi_4=\)-0.1190496,
\(\theta_1=\)-0.5134533, \(\Phi_1=\)-0.0165048, \(\phi_2=\)-0.0992696,
\$\Phi\_3=\(0.014147,\)\Phi\_4=\(-0.1144051,\)\Phi\_5=\$-0.0758144,
\(\Theta_1=\)-0.8296747

The standardized residuals seems to be random, and there are not clear
trend. The residuals seems homoscedastic and are centered at zero, which
is a good indcation that our models assumptions are held by the data.

Looking at the autocorrolation plot, there does not seem to be any lag
corrolating that much. Still, there are a few outliers, but that is
often on 12+ months and can be considered to be well within the range of
some family wise error rate.

Points in the qq-plot also seems to align with the normal line quite
well, which indicate a good fit for our model.

We can also plot the model fit, versus the real values, getting the
following:

the model seems to fit the data nicely.

All in all, the model seem to fit the data quite well.

\hypertarget{confidence-interval-for-coefficients}{%
\subsection{Confidence interval for
coefficients}\label{confidence-interval-for-coefficients}}

We use bootstrapping to create confidence intervals for the
coeffiecient. In using bootstraping we create a simulated data-set by
drawing at random from our original data set, and fit a model using
this. We repeat this, and in the end get a set of possible coefficient
values, which we can use to confidence intervals.

For the coefficients we get the following bootstrapped confidence
intervals (95\%):

\hypertarget{forecasting-and-bootstrapping}{%
\subsection{Forecasting and
bootstrapping}\label{forecasting-and-bootstrapping}}

Bootstrapping can also be used to obtain prediction interval. The ones
gained with traditional methods is often too narrow. (REFERENCE) We will
use a a blocked bootstrap, we select adjunct sections the time series at
random and join the selections together.

The method used in this section is adapted from (REFERENCE) chapter on
bootstrapping and bagging.

An example of how bootstrapped data would look like:

We the fit different models, on 100 bootstrap samples:

\hypertarget{discussion}{%
\section{Discussion}\label{discussion}}

The model seem to predict an increase of the co2 levels in the next
year. And seem to be quite confident on its predictions.

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

\hypertarget{references}{%
\section{References}\label{references}}


\end{document}
